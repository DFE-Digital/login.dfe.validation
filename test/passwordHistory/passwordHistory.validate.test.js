const passwordHistory = require('../../src/passwordHistory');

test('object is newed up', () => {

    const historylist = [{id:'98ffdc5a-b341-4d5f-a5f2-128f58bcba82',password:'+/Wk4qgyJLcTukGML9bTC2TmHB0kIJAWyHFaa2mE08RsNwToz0YKvMqsTOBmNA+VGa/0b9aHeazVjDUt65gbguhUb+kLv2ar7YNlpqbZHgD0jBCTFx+WizKUSB1b0Nq+cVDqx4VC7nK42iDRvNiug4c0sv8BV5q/RgIUn4XyAWdY7+g/Ur4y3HteoiJfJFNyPRd6hKffc89Ot1RJ1kH0wla2kkyTBJ7qFNbJsIo1sxg7sLzZ4OZIozjtfi5nB7wlkTsmLATPlthWbMIiHi1C1u4WMd5Gr1HbEgk/TE6OMhXRWvbB7GYKFmhhCU5BSiRKoEVoUo1rjNrhyXVfsLJxyctTbt3xPEcmvO5Axnc/jGG6ouE1kTkwzFMVSXbxTJ81+mg3G8D2TGFSgdRhdkVITH2oO9f/bBa+Zw+SIWr5Ez7rvao+OVhUEM7kHLhPVXkqMD/IFKOu6NAqJr4S97v2rIgmnWTsvgdWCGyPU5n3n2mM8xXezNslSbcWt8nFpbw2kndMxM5yCbuY2u8BFpoXQbTGXygXfyHVQSTBCZ+CNzEoOuSyMC2BXZ4i8CkyH67EhFFAgwPmEFiRXUugDwGo77RNMhVY5+l/cKAaWuil1CUiLakiROvFzzN4+m70DmbGS7PGI5OR/mIOBh7KcA+LERZj+lRqsrnifY2qN1H44QA=',	salt:'a*%s28J3N<Y+EdrThMmE7prab',CreatedAt:'2023-11-21 12:39:42.7900000',UpdateAt:'2023-11-21 12:39:42.6530000'},{id:'d65d02a4-8432-4883-ade3-21b3f509136c',	password:'lh4Du12r/VM/bwzt4Dgp1x07QoPhWIaOE5ot1NFvmp9PZJ5BE0MXBvMfycQk5OMYSSzTkyvDG85YRCU3sBcfadOwYSc9Y6F7dhbNd4EferhvU8uA3ok8sQxlvj6X9KiuK/O3KjApZ5A1Lo9wvDQqftdMn2qN4tMgU+qhUxWbqIt3q3f/OXCxpSrfKkWIwq4oyi9ek2NqE97CLoIYxaLEKKqcjP44iWK9CUC1lsXEDYaKmPjT0rkFaz1lgdMeCukwh8QEnUMUdUv/rgyaTHMP2040EjY90wddi4QFCZ2ekc7fBaIiDhBGYkFZxJXlZfc9Y9WlorTJGFHDxo0iVlLtKf85E1oQaNuibubrrthsemq9sMSl17n8d091CAWcfEyzSp6lJnaTGsCtLZ69aUCFoBL1Sdj9pZlzgCdfLRPLPKY6NFKlSrqmNmFQRvZf5wGoxyibKx47qVkjZLkkAfY9gR8vEJPHZs6MK+s8souZ67jW5fnCEpoFJ7fXt5NcHb1o3nFUz9/Sy0o2BGXbBjKXIOpgLjzMcxLDOD8yEdqb7euh0UlIU1iePoZnNIYWxe6EpnY5BdnU6ncex0xlo+ng7eyDZoLg0kCKFIIKk2BGf+03ZG5CY/+0GWswNRvf62JhMsj8Fh+WCGWsZz0UJ3JlBuEnboBUzXPKj0x4uOp/zSs=',salt:'DKCwJr.y7QDCN>WafWx@jCR8&',CreatedAt:'2023-11-21 10:37:33.3433333',	UpdatedAt:'2023-11-21 10:37:33.2600000'},
    {id:'14d88f41-9841-4ebb-9e9f-580093dd147e',	password:'RYFJYlxXWlXedlVT5jBEaquv+KNpqlYd+B5i4du+H59d82vkiBNz2HKg7ZKAPoIPehD9o1PYMX7yhZlCUUmy3az9uLqN+bUHOI3M7WS0qMpnJRFTIAMvJX7pEn7CcQoY6DvGLcQZFVWdMsZdphbknKAF9bwv/SvW+Ky27Yu0Ajx3Jp5wXIuic0yxWhQy6fCzOL3XQEGHfr4kZEFZBQTza8qXW/OlAz2iSv5AKOMvfH6JmYe9r6pxlbz23sTKgXxA1bjgRyzYiBaj6uu3IRkVjI/fQiSI+yGJobxH/UYjEcgiDzcNBhqt2BcZdn3/zgNPx9kepgZnYb8zl8iiP9fRqbZamB6A6sIqzr4DQpWl4PdK+vyX7P8XtbtyYnMBMZWhxNAE8aJgergyI5lqr/LEx362h6ZjeteclxeTjv79+8J+sQU1O6xO4MhdzfdtkhCyeaqt6jHJNN/udmoVxsxQQu/tlQ8ypOQ2r/HRM6PvPmRlVEXq5RHUi5rRj585y9HJ5ZcZmS50qe1p/9yvjcIdZNGcFoLhltyBBSuwg1eICDPnm6wI1j1WJbHIb/+uYAQy0hYR4OuC+/6z4/8a8DF6AuAzijEElsZ61hUXht231mTfP05/O+u6NH47LMf+43Y3dNBPN6CA4m1R28bpoV5LJu384DwiSlIEVCOrEk169wc=',	salt:'gE+T@!B!fPNX.fw5jYTc7Bkxs',CreatedAt:'2023-11-21 10:33:17.1966667',UpdateAt:'2023-11-21 10:33:17.1200000'}];
    const policyCode = 'v3';
    const password = 'HA77in3ss01';
    const passHist = new passwordHistory(historylist,password,policyCode);
    expect(passHist.newPass).toBe(password);
  });


  test('password valided and found to be used before', () => {

    const historylist = [{id:'98ffdc5a-b341-4d5f-a5f2-128f58bcba82',password:'+/Wk4qgyJLcTukGML9bTC2TmHB0kIJAWyHFaa2mE08RsNwToz0YKvMqsTOBmNA+VGa/0b9aHeazVjDUt65gbguhUb+kLv2ar7YNlpqbZHgD0jBCTFx+WizKUSB1b0Nq+cVDqx4VC7nK42iDRvNiug4c0sv8BV5q/RgIUn4XyAWdY7+g/Ur4y3HteoiJfJFNyPRd6hKffc89Ot1RJ1kH0wla2kkyTBJ7qFNbJsIo1sxg7sLzZ4OZIozjtfi5nB7wlkTsmLATPlthWbMIiHi1C1u4WMd5Gr1HbEgk/TE6OMhXRWvbB7GYKFmhhCU5BSiRKoEVoUo1rjNrhyXVfsLJxyctTbt3xPEcmvO5Axnc/jGG6ouE1kTkwzFMVSXbxTJ81+mg3G8D2TGFSgdRhdkVITH2oO9f/bBa+Zw+SIWr5Ez7rvao+OVhUEM7kHLhPVXkqMD/IFKOu6NAqJr4S97v2rIgmnWTsvgdWCGyPU5n3n2mM8xXezNslSbcWt8nFpbw2kndMxM5yCbuY2u8BFpoXQbTGXygXfyHVQSTBCZ+CNzEoOuSyMC2BXZ4i8CkyH67EhFFAgwPmEFiRXUugDwGo77RNMhVY5+l/cKAaWuil1CUiLakiROvFzzN4+m70DmbGS7PGI5OR/mIOBh7KcA+LERZj+lRqsrnifY2qN1H44QA=',	salt:'a*%s28J3N<Y+EdrThMmE7prab',CreatedAt:'2023-11-21 12:39:42.7900000',UpdateAt:'2023-11-21 12:39:42.6530000'},{id:'d65d02a4-8432-4883-ade3-21b3f509136c',	password:'lh4Du12r/VM/bwzt4Dgp1x07QoPhWIaOE5ot1NFvmp9PZJ5BE0MXBvMfycQk5OMYSSzTkyvDG85YRCU3sBcfadOwYSc9Y6F7dhbNd4EferhvU8uA3ok8sQxlvj6X9KiuK/O3KjApZ5A1Lo9wvDQqftdMn2qN4tMgU+qhUxWbqIt3q3f/OXCxpSrfKkWIwq4oyi9ek2NqE97CLoIYxaLEKKqcjP44iWK9CUC1lsXEDYaKmPjT0rkFaz1lgdMeCukwh8QEnUMUdUv/rgyaTHMP2040EjY90wddi4QFCZ2ekc7fBaIiDhBGYkFZxJXlZfc9Y9WlorTJGFHDxo0iVlLtKf85E1oQaNuibubrrthsemq9sMSl17n8d091CAWcfEyzSp6lJnaTGsCtLZ69aUCFoBL1Sdj9pZlzgCdfLRPLPKY6NFKlSrqmNmFQRvZf5wGoxyibKx47qVkjZLkkAfY9gR8vEJPHZs6MK+s8souZ67jW5fnCEpoFJ7fXt5NcHb1o3nFUz9/Sy0o2BGXbBjKXIOpgLjzMcxLDOD8yEdqb7euh0UlIU1iePoZnNIYWxe6EpnY5BdnU6ncex0xlo+ng7eyDZoLg0kCKFIIKk2BGf+03ZG5CY/+0GWswNRvf62JhMsj8Fh+WCGWsZz0UJ3JlBuEnboBUzXPKj0x4uOp/zSs=',salt:'DKCwJr.y7QDCN>WafWx@jCR8&',CreatedAt:'2023-11-21 10:37:33.3433333',	UpdatedAt:'2023-11-21 10:37:33.2600000'},
    {id:'14d88f41-9841-4ebb-9e9f-580093dd147e',	password:'RYFJYlxXWlXedlVT5jBEaquv+KNpqlYd+B5i4du+H59d82vkiBNz2HKg7ZKAPoIPehD9o1PYMX7yhZlCUUmy3az9uLqN+bUHOI3M7WS0qMpnJRFTIAMvJX7pEn7CcQoY6DvGLcQZFVWdMsZdphbknKAF9bwv/SvW+Ky27Yu0Ajx3Jp5wXIuic0yxWhQy6fCzOL3XQEGHfr4kZEFZBQTza8qXW/OlAz2iSv5AKOMvfH6JmYe9r6pxlbz23sTKgXxA1bjgRyzYiBaj6uu3IRkVjI/fQiSI+yGJobxH/UYjEcgiDzcNBhqt2BcZdn3/zgNPx9kepgZnYb8zl8iiP9fRqbZamB6A6sIqzr4DQpWl4PdK+vyX7P8XtbtyYnMBMZWhxNAE8aJgergyI5lqr/LEx362h6ZjeteclxeTjv79+8J+sQU1O6xO4MhdzfdtkhCyeaqt6jHJNN/udmoVxsxQQu/tlQ8ypOQ2r/HRM6PvPmRlVEXq5RHUi5rRj585y9HJ5ZcZmS50qe1p/9yvjcIdZNGcFoLhltyBBSuwg1eICDPnm6wI1j1WJbHIb/+uYAQy0hYR4OuC+/6z4/8a8DF6AuAzijEElsZ61hUXht231mTfP05/O+u6NH47LMf+43Y3dNBPN6CA4m1R28bpoV5LJu384DwiSlIEVCOrEk169wc=',	salt:'gE+T@!B!fPNX.fw5jYTc7Bkxs',CreatedAt:'2023-11-21 10:33:17.1966667',UpdateAt:'2023-11-21 10:33:17.1200000'}];
    const policyCode = 'v3';
    const password = 'PA55ion90';
    const passHist = new passwordHistory(historylist,password,policyCode);
    expect(passHist.validate()).toBe(false);
  });

  
  test('password valided and found not to be used before', () => {

    const historylist = [{id:'98ffdc5a-b341-4d5f-a5f2-128f58bcba82',password:'+/Wk4qgyJLcTukGML9bTC2TmHB0kIJAWyHFaa2mE08RsNwToz0YKvMqsTOBmNA+VGa/0b9aHeazVjDUt65gbguhUb+kLv2ar7YNlpqbZHgD0jBCTFx+WizKUSB1b0Nq+cVDqx4VC7nK42iDRvNiug4c0sv8BV5q/RgIUn4XyAWdY7+g/Ur4y3HteoiJfJFNyPRd6hKffc89Ot1RJ1kH0wla2kkyTBJ7qFNbJsIo1sxg7sLzZ4OZIozjtfi5nB7wlkTsmLATPlthWbMIiHi1C1u4WMd5Gr1HbEgk/TE6OMhXRWvbB7GYKFmhhCU5BSiRKoEVoUo1rjNrhyXVfsLJxyctTbt3xPEcmvO5Axnc/jGG6ouE1kTkwzFMVSXbxTJ81+mg3G8D2TGFSgdRhdkVITH2oO9f/bBa+Zw+SIWr5Ez7rvao+OVhUEM7kHLhPVXkqMD/IFKOu6NAqJr4S97v2rIgmnWTsvgdWCGyPU5n3n2mM8xXezNslSbcWt8nFpbw2kndMxM5yCbuY2u8BFpoXQbTGXygXfyHVQSTBCZ+CNzEoOuSyMC2BXZ4i8CkyH67EhFFAgwPmEFiRXUugDwGo77RNMhVY5+l/cKAaWuil1CUiLakiROvFzzN4+m70DmbGS7PGI5OR/mIOBh7KcA+LERZj+lRqsrnifY2qN1H44QA=',	salt:'a*%s28J3N<Y+EdrThMmE7prab',CreatedAt:'2023-11-21 12:39:42.7900000',UpdateAt:'2023-11-21 12:39:42.6530000'},{id:'d65d02a4-8432-4883-ade3-21b3f509136c',	password:'lh4Du12r/VM/bwzt4Dgp1x07QoPhWIaOE5ot1NFvmp9PZJ5BE0MXBvMfycQk5OMYSSzTkyvDG85YRCU3sBcfadOwYSc9Y6F7dhbNd4EferhvU8uA3ok8sQxlvj6X9KiuK/O3KjApZ5A1Lo9wvDQqftdMn2qN4tMgU+qhUxWbqIt3q3f/OXCxpSrfKkWIwq4oyi9ek2NqE97CLoIYxaLEKKqcjP44iWK9CUC1lsXEDYaKmPjT0rkFaz1lgdMeCukwh8QEnUMUdUv/rgyaTHMP2040EjY90wddi4QFCZ2ekc7fBaIiDhBGYkFZxJXlZfc9Y9WlorTJGFHDxo0iVlLtKf85E1oQaNuibubrrthsemq9sMSl17n8d091CAWcfEyzSp6lJnaTGsCtLZ69aUCFoBL1Sdj9pZlzgCdfLRPLPKY6NFKlSrqmNmFQRvZf5wGoxyibKx47qVkjZLkkAfY9gR8vEJPHZs6MK+s8souZ67jW5fnCEpoFJ7fXt5NcHb1o3nFUz9/Sy0o2BGXbBjKXIOpgLjzMcxLDOD8yEdqb7euh0UlIU1iePoZnNIYWxe6EpnY5BdnU6ncex0xlo+ng7eyDZoLg0kCKFIIKk2BGf+03ZG5CY/+0GWswNRvf62JhMsj8Fh+WCGWsZz0UJ3JlBuEnboBUzXPKj0x4uOp/zSs=',salt:'DKCwJr.y7QDCN>WafWx@jCR8&',CreatedAt:'2023-11-21 10:37:33.3433333',	UpdatedAt:'2023-11-21 10:37:33.2600000'},
    {id:'14d88f41-9841-4ebb-9e9f-580093dd147e',	password:'RYFJYlxXWlXedlVT5jBEaquv+KNpqlYd+B5i4du+H59d82vkiBNz2HKg7ZKAPoIPehD9o1PYMX7yhZlCUUmy3az9uLqN+bUHOI3M7WS0qMpnJRFTIAMvJX7pEn7CcQoY6DvGLcQZFVWdMsZdphbknKAF9bwv/SvW+Ky27Yu0Ajx3Jp5wXIuic0yxWhQy6fCzOL3XQEGHfr4kZEFZBQTza8qXW/OlAz2iSv5AKOMvfH6JmYe9r6pxlbz23sTKgXxA1bjgRyzYiBaj6uu3IRkVjI/fQiSI+yGJobxH/UYjEcgiDzcNBhqt2BcZdn3/zgNPx9kepgZnYb8zl8iiP9fRqbZamB6A6sIqzr4DQpWl4PdK+vyX7P8XtbtyYnMBMZWhxNAE8aJgergyI5lqr/LEx362h6ZjeteclxeTjv79+8J+sQU1O6xO4MhdzfdtkhCyeaqt6jHJNN/udmoVxsxQQu/tlQ8ypOQ2r/HRM6PvPmRlVEXq5RHUi5rRj585y9HJ5ZcZmS50qe1p/9yvjcIdZNGcFoLhltyBBSuwg1eICDPnm6wI1j1WJbHIb/+uYAQy0hYR4OuC+/6z4/8a8DF6AuAzijEElsZ61hUXht231mTfP05/O+u6NH47LMf+43Y3dNBPN6CA4m1R28bpoV5LJu384DwiSlIEVCOrEk169wc=',	salt:'gE+T@!B!fPNX.fw5jYTc7Bkxs',CreatedAt:'2023-11-21 10:33:17.1966667',UpdateAt:'2023-11-21 10:33:17.1200000'}];
    const policyCode = 'v3';
    const password = 'PO55ion90';
    const passHist = new passwordHistory(historylist,password,policyCode);
    expect(passHist.validate()).toBe(true);
  });