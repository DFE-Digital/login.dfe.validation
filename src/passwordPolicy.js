const doesPasswordMeetPolicy = (password) => {
  if (!password || !password.match(/^.{12,64}$/)) {
    return false;
  }

  return true;
};

const doesPasswordMeetNewPolicy = (password) => {
  /*
   (?=(.*\d){2}) --> atleast 2 digits
   (?=(.*[a-z]){2}) --> atleast 2 lower case chars
   (?=(.*[A-Z]){2}) --> atleast 2 upper case chars
  */

  if (!password || !password.match(/^.{8,64}$/)) {
    return false;
  } else if(!password.match(/(?=(.*\d){2})(?=(.*[a-z]){2})(?=(.*[A-Z]){2})/)) {
    return false;
  }

  return true;
};

const isPasswordBlackListed = (password) => {
  const blacklistedPasswordsList = process.env.blacklistedPasswords || blacklistedPasswords();
  return blacklistedPasswordsList.some(blacklistedpassword =>  blacklistedpassword.toLowerCase() === password.toLowerCase())
}

const blacklistedPasswords = () => {
  return [
    "1q2w3e4r5t6y7u8i9o0p",
    "PolniyPizdec110211",
    "1.23457E+17",
    "1.23457E+17",
    "YfDbUfNjH10305070",
    "PolniyPizdec0211",
    "PE#5GZ29PTZMSE",
    "megaparol12345",
    "Sojdlg123aljg",
    "MaprCheM56458",
    "5532361cnjqrf",
    "q1w2e3r4t5y6",
    "1qaz2wsx3edc",
    "111222tianya",
    "1q2w3e4r5t6y",
    "qwerty123456",
    "123qweasdzxc",
    "N8ZGT5P0sHw=",
    "123456qwerty",
    "1.23457E+11",
    "1.23456E+11",
    "1.23457E+11",
    "1.12233E+11",
    "qweasdzxc123",
    "qazwsxedc123",
    "12345678910",
    "qwerty12345",
    "password123",
    "123hfjdk147",
    "421uiopy258",
    "12345qwerty",
    "W5tXn36alfW",
    "yuantuo2012",
    "1234567890q",
    "1234567890a",
    "nks230kjs82",
    "12345678900",
    "iloveyou123",
    "1234567890",
    "1q2w3e4r5t",
    "passer2009",
    "123456789a",
    "FQRG7CS493",
    "1111111111",
    "password12",
    "3rJs1la7qE",
    "1234567891",
    "12345qwert",
    "q1w2e3r4t5",
    "a123456789",
    "1234554321",
    "myspace123",
    "123456789q",
    "4815162342",
    "9876543210",
    "1v7Upjw3nT",
    "1122334455",
    "1029384756",
    "uQA9Ebw445",
    "iloveyou12",
    "qwerty1234",
    "YAgjecc826",
    "1234512345",
    "P3Rat54797",
    "qwert12345",
    "5555555555",
    "1123581321",
    "3d8Cubaj2E",
    "zxcvbnm123",
    "password11",
    "princess12",
    "babygirl12",
    "abcdefg123",
    "fuckyou123",
    "password01",
    "Groupd2013",
    "3Odi15ngxB",
    "qti7Zxh18U",
    "football12",
    "123456789m",
    "123456789z",
    "g9l2d1fzPY",
    "welcome123",
    "dIWtgm8492",
    "7894561230",
    "vRbGQnS997",
    "password13",
    "baseball12",
    "x4ivygA51F",
    "pokemon123",
    "123456789s",
    "Tnk0Mk16VX",
    "2012comeer",
    "password10",
    "spartan117",
    "passer2011",
    "1234567899",
    "123456789j",
    "9999999999",
    "abcde12345",
    "password00",
    "6hBf28W791",
    "password69",
    "password22",
    "123456789k",
    "5hsU75kpoT",
    "2222222222",
    "a1b2c3d4e5",
    "123456789d",
    "porsche911",
    "OcPOOok325",
    "123456789l",
    "123456789p",
    "7777777777",
    "football10",
    "1357924680",
    "password23",
    "123456789o",
    "superman12",
    "5xfgs3Ii9D",
    "y6p67FtrqJ",
    "baseball11",
    "baseball10",
    "babygirl13",
    "princess10",
    "987654321a",
    "football11",
    "1Fr2rfq7xL",
    "michael123",
    "iloveyou13",
    "iloveyou22",
    "123456789b",
    "iloveyou14",
    "password21",
    "1a2b3c4d5e",
    "iloveyou11",
    "princess13",
    "1020304050",
    "princess11",
    "q123456789",
    "d71lWz9zjS",
    "UvGX8f8232",
    "jessica123",
    "babygirl10",
    "123456789",
    "qwerty123",
    "target123",
    "987654321",
    "gwerty123",
    "123123123",
    "789456123",
    "123456789",
    "147258369",
    "987654321",
    "123654789",
    "147852369",
    "123qweasd",
    "999999999",
    "741852963",
    "N0=Acc3ss",
    "qazwsx123",
    "12345678a",
    "123456abc",
    "963852741",
    "123qwe123",
    "abc123456",
    "123698745",
    "a12345678",
    "career121",
    "123454321",
    "111222333",
    "monkey123",
    "111111111",
    "147896325",
    "asdasd123",
    "192837465",
    "321654987",
    "killer123",
    "myspace12",
    "123321123",
    "forever21",
    "135792468",
    "123456123",
    "soccer123",
    "123789456",
    "1qa2ws3ed",
    "qwerty321",
    "fuckyou69",
    "qweasd123",
    "123456987",
    "asdqwe123",
    "naruto123",
    "asd123456",
    "fuku00198",
    "dragon123",
    "Sample123",
    "123qwerty",
    "daniel123",
    "azerty123",
    "youbye123",
    "123456qwe",
    "369258147",
    "987456321",
    "123456asd",
    "master123",
    "schalke04",
    "shadow123",
    "cookie123",
    "fuckyou12",
    "qwe123qwe",
    "google123",
    "1q2w3e4r5",
    "alladin79",
    "loveme123",
    "jordan123",
    "slayer666",
    "pokemon12",
    "ashley123",
    "love12345",
    "classof09",
    "12345678q",
    "hottie101",
    "nicole123",
    "qwe123456",
    "hannah123",
    "justin123",
    "myspace11",
    "jumpman23",
    "purple123",
    "secret666",
    "134679852",
    "america10",
    "austin316",
    "flower123",
    "cheese123",
    "12345678",
    "1qaz2wsx",
    "1q2w3e4r",
    "1g2w3e4r",
    "zag12wsx",
    "1234qwer",
    "11111111",
    "abcd1234",
    "jordan23",
    "12qwaszx",
    "88888888",
    "blink182",
    "qwer1234",
    "j38ifUbn",
    "q1w2e3r4",
    "qwerty12",
    "asdf1234",
    "fuk19600",
    "29rsavoy",
    "12341234",
    "1qazxsw2",
    "hello123",
    "12344321",
    "dpbk1234",
    "11223344",
    "zaq12wsx",
    "87654321",
    "1234567a",
    "a838hfiD",
    "1234abcd",
    "super123",
    "a1b2c3d4",
    "iw14Fi9j",
    "12121212",
    "a1234567",
    "qqww1122",
    "aa123456",
    "1a2b3c4d",
    "qwert123",
    "angel123",
    "pa55word",
    "lakers24",
    "happy123",
    "satan666",
    "love1234",
    "55555555",
    "rush2112",
    "21212121",
    "lebron23",
    "money123",
    "22222222",
    "abc12345",
    "qq123456",
    "soccer12",
    "qw123321",
    "soccer10",
    "iG4abOX4",
    "123456aa",
    "jesus123",
    "bitch123",
    "apple123",
    "monkey12",
    "chris123",
    "77777777",
    "hallo123",
    "pass1234",
    "soccer11",
    "25802580",
    "31415926",
    "19871987",
    "jesus777",
    "99999999",
    "1qaz1qaz",
    "a1s2d3f4",
    "19851985",
    "zaq1xsw2",
    "admin123",
    "12369874",
    "1234567q",
    "india123",
    "69696969",
    "19841984",
    "green123",
    "19861986",
    "james123",
    "14789632",
    "soccer13",
    "1234asdf",
    "19891989",
    "sureno13",
    "19921992",
    "test1234",
    "summer08",
    "comeon11",
    "zxcv1234",
    "gordon24",
    "19821982",
    "19801980",
    "david123",
    "11112222",
    "qazwsx12",
    "smoke420",
    "buddy123",
    "11235813",
    "music123",
    "qwe12345",
    "pa55w0rd",
    "12301230",
    "19831983",
    "13131313",
    "10101010",
    "fordf150",
    "10203040",
    "19951995",
    "66666666",
    "qwerty11",
    "tiger123",
    "evony192",
    "19881988",
    "20102010",
    "fuckme69",
    "devil666",
    "12qw23we",
    "44444444",
    "12131415",
    "summer09",
    "sk84life",
    "14531453",
    "19941994",
    "19931993",
    "dragon12",
    "killer12",
    "agent007",
    "33333333",
    "lucky123",
    "19901990",
    "death666",
    "19811981",
    "shadow12",
    "dalejr88",
    "kitty123",
    "loser123",
    "summer07",
    "19911991",
    "candy123",
    "mommy123",
    "19781978",
    "lover123",
    "molly123",
    "bella123",
    "sammy123",
    "soccer14",
    "akopa123",
    "12345679",
    "19791979",
    "naruto12",
    "20092009",
    "19751975",
    "zxasqw12",
    "yahoo123",
    "aaron431",
    "98765432",
    "monkey11",
    "19961996",
    "wow12345",
    "kevin123",
    "smile123",
    "jordan12",
    "ncc1701d",
    "20082008",
    "apollo13",
    "12345qwe",
    "asdfg123",
    "aobo2010",
    "nicole12",
    "12345abc",
    "19761976",
    "monkey13",
    "rocky123",
    "black123",
    "19731973",
    "as123456",
    "purple12",
    "soccer15",
    "maria123",
    "1a2s3d4f",
    "123456as",
    "tyler123",
    "ashley12",
    "23232323",
    "cutie123",
    "19771977",
    "daniel12",
    "19971997",
    "monkey22",
    "25252525",
    "daddy123",
    "12345671",
    "jason123",
    "pizza123",
    "power123",
    "metal666",
    "123456qw",
    "19741974",
    "aaaa1111",
    "soccer22",
    "baller23",
    "eleven11",
    "peter123",
    "asdf3423",
    "sarah123",
    "23456789",
    "f00tball",
    "cookie12",
    "soccer17",
    "hawaii50",
    "24682468",
    "123456ab",
    "blue1234",
    "london12",
    "daisy123",
    "master12",
    "pk3x7w9W",
    "mexico13",
    "crazy123",
    "25251325",
    "justin12",
    "r2d2c3po",
    "a1a2a3a4"
  ]
}

module.exports = {
  doesPasswordMeetPolicy,
  doesPasswordMeetNewPolicy,
  isPasswordBlackListed,
};
